import pandas as pd
import matplotlib.pyplot as plt

# =========================
# 1. DATA KUESIONER
# =========================
data = [
    [2,2,4,2,3],[2,2,3,2,3],[3,2,4,3,2],[3,2,4,1,3],[3,2,4,1,3],
    [1,0,4,1,3],[3,0,3,1,2],[4,2,3,2,4],[3,5,4,1,4],[3,5,4,1,3],
    [2,0,4,1,3],[4,8,3,2,3],[4,10,3,1,3],[4,2,4,1,3],[4,8,2,1,3],
    [4,0,4,1,3],[4,10,3,3,5],[4,10,3,3,3],[2,0,3,1,1],[4,5,4,1,4],
    [4,5,3,2,3],[4,10,4,1,2],[4,5,4,2,3],[1,0,3,1,3],[3,2,3,4,2],
    [2,2,4,1,3],[3,0,3,1,2],[4,2,4,1,3],[3,2,4,2,3],[4,5,3,2,3],
    [3,5,3,1,3],[3,2,4,1,3],[1,2,4,1,2],[4,2,4,2,4],[1,0,1,1,3],
    [1,0,3,1,5],[4,8,3,2,3],[2,2,4,3,3],[4,5,3,2,3],[3,2,4,1,3],
    [4,5,3,3,2],[4,2,4,1,3],[3,2,4,1,3],[2,2,4,1,3],[3,2,4,1,3],
    [4,2,4,1,3],[3,2,4,2,3],[4,8,3,1,3],[4,5,3,2,3],[2,2,4,1,3],
    [3,5,4,1,3],[3,2,4,1,3],[4,8,4,1,3],[4,8,3,3,3],[2,2,4,1,3],
    [3,2,4,2,3],[4,8,3,3,3],[3,5,4,1,3],[3,2,4,1,3],[3,2,4,1,3],
    [1,0,4,1,3],[2,2,4,1,3],[3,2,4,1,3],[3,2,4,1,3],[3,2,4,1,3],
    [2,2,4,1,3],[3,2,4,1,3],[3,5,4,1,3],[2,2,4,1,3],[4,2,4,1,3],
    [2,2,4,1,3],[2,2,4,1,3],[3,2,4,1,3],[3,2,4,1,3],[2,2,4,1,3],
    [1,0,4,1,3],[4,5,4,1,3],[4,2,4,1,3],[3,2,4,1,3],[3,2,4,1,3],
    [3,2,4,1,3],[3,2,4,1,3],[3,10,4,1,3]
]

df = pd.DataFrame(data, columns=["Q1","Q2","Q3","Q4","Q5"])

# =========================
# 2. HISTOGRAM RENTANG SETIAP PERTANYAAN
# =========================
bins_dict = {
    "Q1": [0.5,1.5,2.5,3.5,4.5],
    "Q2": [0,2,5,8,10,12],
    "Q3": [0.5,1.5,2.5,3.5,4.5],
    "Q4": [0.5,1.5,2.5,3.5,4.5],
    "Q5": [0.5,1.5,2.5,3.5,4.5,5.5]
}

for col in df.columns:
    plt.figure()
    plt.hist(df[col], bins=bins_dict[col], edgecolor="black")
    plt.title(f"Histogram Rentang {col}")
    plt.xlabel("Nilai")
    plt.ylabel("Frekuensi")
    plt.show()

# =========================
# 3. HISTOGRAM TOTAL (GABUNGAN 5 PERTANYAAN)
# =========================
df["Total_Skor"] = df.sum(axis=1)

plt.figure()
plt.hist(df["Total_Skor"], bins=10, edgecolor="black")
plt.title("Histogram Rentang Total Skor Keterlibatan & Kehadiran")
plt.xlabel("Total Skor")
plt.ylabel("Frekuensi")
plt.show()

# =========================
# 4. HISTOGRAM RENTANG SAMPEL PER MINGGU (4 MINGGU)
# =========================
# GANTI NILAI INI SESUAI DATA DI EXCEL ANDA
sample_per_minggu = [7, 19, 25, 32]  # persen

total_sample = len(df)
jumlah_minggu = [round(p/100 * total_sample) for p in sample_per_minggu[:-1]]
jumlah_minggu.append(total_sample - sum(jumlah_minggu))

minggu_data = []
for i, jumlah in enumerate(jumlah_minggu, start=1):
    minggu_data.extend([i] * jumlah)

plt.figure()
plt.hist(minggu_data, bins=[0.5,1.5,2.5,3.5,4.5], edgecolor="black")
plt.title("Histogram Rentang Pengumpulan Sampel per Minggu")
plt.xlabel("Minggu ke-")
plt.ylabel("Jumlah Sampel")
plt.xticks([1,2,3,4])
plt.show()
